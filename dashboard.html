<!DOCTYPE html>
<html lang="fr" class="page">
<head>
  <meta charset="UTF-8">
  <title>Tableau de bord ‚Äì ContextaLingua</title>
  <!-- Favicon & App icons -->
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <link rel="manifest" href="/icons/site.webmanifest">

    <meta name="theme-color" content="#0b1020">
  <meta name="robots" content="noindex, nofollow">
  <link rel="stylesheet" href="assets/css/style.css">
  <script defer src="https://stats.contextalingua.fr/script.js" data-website-id="481106be-9f9b-42d9-9506-f6bded974ca5"></script>
</head>

<body>
<header class="site-header">
  <div class="container header-inner">
    <!-- Logo -->
    <a href="index.html" class="header-logo">
      <span class="contexta">Contexta</span>
      <span class="lingua">Lingua</span>
    </a>

    <!-- Navigation principale -->
    <nav class="main-nav">
      <!-- Menu PUBLIC : visible quand on n‚Äôest PAS connect√© -->
      <a href="produit.html" class="nav-link nav-public-only">Produit</a>
      <a href="tarifs.html"  class="nav-link nav-public-only">Tarifs</a>
      <a href="faq.html"     class="nav-link nav-public-only">FAQ</a>

      <!-- Menu UTILISATEUR : visible UNIQUEMENT quand on est connect√© -->
      <a href="index.html"      class="nav-link nav-auth-only">Accueil</a>
      <a href="dashboard.html"  class="nav-link nav-auth-only">Tableau de bord</a>
      <a href="generate.html"   class="nav-link nav-auth-only">R√©daction</a>
      <a href="interpret.html"  class="nav-link nav-auth-only">Interpr√©tation</a>
      <!-- Mode accompagn√© supprim√© -->
    </nav>

    <!-- Zone de droite -->
    <div class="header-actions">
      <!-- Email + d√©connexion : visibles quand connect√© -->
      <span id="headerUserEmail" class="nav-link nav-auth-only"></span>
      <button id="btnLogout" class="btn btn-ghost nav-auth-only">
        D√©connexion
      </button>

      <!-- Actions publiques : visibles quand NON connect√© -->
      <button class="btn btn-ghost nav-public-only">
        Se connecter
      </button>
      <button class="btn btn-primary nav-public-only">
        Commencer gratuitement
      </button>
    </div>
  </div>
</header>

<!-- TOAST (inject√©/contr√¥l√© par dashboard.js) -->
<div id="toastContainer"
     style="position:fixed;right:16px;top:16px;z-index:9999;display:flex;flex-direction:column;gap:10px;pointer-events:none;">
</div>

<main>
  <section class="hero">
    <div class="container hero-grid hero-grid-simple">

      <!-- Carte utilisateur -->
      <div class="card" style="margin-bottom: 20px;">
        <h2 style="margin-bottom: 10px; color: var(--text-strong);">Votre espace</h2>
        <p style="color: var(--text-muted); font-size: 0.95rem;">
          Suivez vos cr√©dits et acc√©dez rapidement aux modes r√©daction et interpr√©tation.
        </p>

        <div style="margin-top: 16px;">
          <p style="font-size: 1.1rem;">
            Cr√©dits disponibles : <strong id="creditBalance">‚Ä¶</strong>
          </p>
        </div>

<section class="section">
  <div class="container">
    <div class="card" style="padding:22px;">
      <h2>Acheter des cr√©dits</h2>
      <p style="margin-top:6px;opacity:.85;">
        Rechargez votre solde en quelques secondes via Mollie.
      </p>

      <div id="packsGrid" class="packs-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-top:16px;"></div>

      <p id="packsError" style="margin-top:12px;color:#ef4444;"></p>
    </div>
  </div>
</section>

        
        <div style="margin-top: 18px; display:flex; gap:12px; flex-wrap:wrap;">
          <a href="generate.html" class="btn btn-primary">‚úç Mode r√©daction</a>
          <a href="interpret.html" class="btn btn-secondary">üîé Mode interpr√©tation</a>
        </div>
      </div>

      <!-- Carte op√©rations -->
      <div class="card">
        <h3 style="margin-bottom: 10px; color: var(--text-strong);">Derni√®res op√©rations de cr√©dits</h3>
        <ul id="transactionsList" style="font-size: 0.9rem; color: var(--text-muted);">
          <li>Chargement en cours‚Ä¶</li>
        </ul>
      </div>

      <!-- Carte ADMIN -->
      <div id="adminPanel" class="card" style="margin-top: 24px; display:none;">
        <h3 style="margin-bottom: 10px; color: var(--text-strong);">
          Administration ‚Äì Gestion des cr√©dits
        </h3>
        <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 14px;">
          Ajustez les cr√©dits d‚Äôun utilisateur, y compris votre propre compte.
        </p>

        <form id="adminCreditForm">
          <div class="form-field">
            <span>Email de l‚Äôutilisateur</span>
            <input type="email" id="adminEmail" placeholder="utilisateur@exemple.com" required>
          </div>

          <div class="form-field">
            <span>Montant de cr√©dits (positif ou n√©gatif)</span>
            <input type="number" id="adminAmount" placeholder="Ex : 20 ou -10" required>
          </div>

          <div class="form-field">
            <span>Motif (optionnel)</span>
            <input type="text" id="adminDescription" placeholder="Offre, ajustement, test‚Ä¶">
          </div>

          <p id="adminMessage" style="font-size:0.9rem; min-height:1.2em; margin-bottom:8px;"></p>

          <button type="submit" class="btn btn-primary">
            Mettre √† jour les cr√©dits
          </button>
        </form>
      </div>

    </div>
  </section>

  <!-- Bloc r√©serv√© au superadmin : gestion des r√¥les -->
  <section class="card" id="rolePanel" style="display:none;">
    <h2>Administration ‚Äì R√¥les des utilisateurs</h2>
    <p>Affectez ou retirez le r√¥le administrateur √† partir de l‚Äôadresse email.</p>

    <form id="roleForm" class="admin-form">
      <div class="form-field">
        <label for="roleEmail">Email de l'utilisateur</label>
        <input type="email" id="roleEmail" placeholder="utilisateur@example.com" required />
      </div>

      <div class="form-field">
        <label for="roleSelect">R√¥le</label>
        <select id="roleSelect">
          <option value="admin">Admin</option>
          <option value="user">Utilisateur simple</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary btn-large">
        Mettre √† jour le r√¥le
      </button>

      <p id="roleMessage" style="margin-top:8px;font-size:0.9rem;"></p>
    </form>
  </section>
</main>

<footer class="site-footer">
  <div class="container footer-inner">
    <span>¬© ContextaLingua</span>
    <nav class="footer-nav">
      <a href="contact.html">Contact</a>
      <a href="cgv.html">CGV</a>
      <a href="confidentialite.html">Confidentialit√©</a>
      <a href="mentions-legales.html">Mentions l√©gales</a>
    </nav>
  </div>
</footer>


<script src="js/api.js"></script>
<script src="js/auth.js"></script>
<script src="js/dashboard.js"></script>
</body>
</html>
