<!DOCTYPE html>
<html lang="fr" class="page">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Interprétation – ContextaLingua</title>
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body>
    <!-- Header standard (identique aux autres pages) -->
    <header class="site-header">
      <div class="container header-inner">
        <a href="index.html" class="header-logo">
          <span class="contexta">Contexta</span>
          <span class="lingua">Lingua</span>
        </a>

        <nav class="main-nav">
          <a href="produit.html" class="nav-link nav-public-only">Produit</a>
          <a href="tarifs.html" class="nav-link nav-public-only">Tarifs</a>
          <a href="faq.html" class="nav-link nav-public-only">FAQ</a>

          <a href="index.html" class="nav-link nav-auth-only">Accueil</a>
          <a href="dashboard.html" class="nav-link nav-auth-only">Tableau de bord</a>
          <a href="generate.html" class="nav-link nav-auth-only">Rédaction</a>
          <a href="interpret.html" class="nav-link nav-auth-only active">Interprétation</a>
          <a href="accompanied.html" class="nav-link nav-auth-only">Mode accompagné</a>
        </nav>

        <div class="header-actions">
          <span id="headerUserEmail" class="nav-link nav-auth-only"></span>
          <button id="btnLogout" class="btn btn-ghost nav-auth-only">Déconnexion</button>

          <a href="login.html" class="btn btn-ghost nav-public-only js-go-login">Se connecter</a>
          <a href="register.html" class="btn btn-primary nav-public-only js-go-register">Tester gratuitement</a>
        </div>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="container hero-grid hero-grid-simple">
          <div class="card" style="width: 100%;">
            <h2 style="margin-bottom: 6px; color: var(--text-strong);">Camille — Interprétation</h2>
            <p style="color: var(--text-muted); margin-bottom: 14px;">
              Collez un message. Camille vous donne la traduction <strong>FR</strong> (par défaut) + une mini lecture (ton / intention / points d’attention).
            </p>

            <form id="interpretForm" autocomplete="off">
              <!-- Option : changer la langue de traduction -->
              <div class="form-field" style="margin-bottom: 10px;">
                <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                  <input id="intToggleTargetLang" type="checkbox" />
                  <span>Traduire vers une autre langue que le français</span>
                </label>
                <p style="margin:6px 0 0; color:var(--text-muted); font-size:.9rem;">
                  Si non coché : traduction en <strong>Français</strong>.
                </p>
              </div>

              <!-- Langue cible (autocomplete) : caché tant que checkbox OFF -->
              <div id="intTargetLangWrap" class="form-field" style="display:none;">
                <span>Langue de traduction</span>
                <div style="position:relative;">
                  <input
                    id="intTargetLanguageLabel"
                    type="text"
                    placeholder="Ex : anglais, italien, arabe…"
                    autocomplete="off"
                  />
                  <input id="intTargetLanguageCode" type="hidden" value="fr" />

                  <div
                    id="intLangSuggest"
                    style="display:none; position:absolute; z-index:20; left:0; right:0; top:100%;
                      background:rgba(2,6,23,.98); border:1px solid var(--border-subtle);
                      border-radius:12px; padding:6px; margin-top:6px; max-height:240px; overflow:auto;"
                  ></div>
                </div>
                <small class="lang-picker-meta">Tape un début de langue puis sélectionne.</small>
              </div>

              <!-- Texte -->
              <div class="form-field">
                <span>Texte à interpréter</span>
                <textarea
                  id="intText"
                  rows="10"
                  placeholder="Collez ici le mail / message reçu…"
                ></textarea>
              </div>

              <!-- Contexte -->
              <div class="form-field">
                <span>Contexte (optionnel)</span>
                <textarea
                  id="intContext"
                  rows="3"
                  placeholder="Relation, enjeux, objectif, ce que vous voulez éviter…"
                ></textarea>
              </div>

              <p id="intError" style="color: var(--danger); font-size:.9rem; min-height:1.2em;"></p>

              <button id="intSubmit" type="submit" class="btn btn-primary btn-full">
                Traduire & interpréter
              </button>
            </form>

            <!-- Résultats -->
            <div class="grid grid-2" style="gap:12px; margin-top:12px; width:100%;">
              <div class="card" style="padding:12px;">
                <div style="display:flex; justify-content:space-between; align-items:center; gap:8px;">
                  <h3 style="margin:0;">Traduction</h3>
                  <button type="button" class="btn btn-ghost" id="btnCopyTranslation">Copier</button>
                </div>
                <pre
                  id="intTranslation"
                  style="white-space:pre-wrap; margin-top:10px; background:#020617;
                    border-radius:12px; padding:12px; border:1px solid var(--border-subtle); min-height:140px;"
                ></pre>
                <p id="intMeta" style="margin-top:8px; color:var(--text-muted); font-size:.9rem;"></p>
              </div>

              <div class="card" style="padding:12px;">
                <h3 style="margin:0 0 10px;">Lecture rapide</h3>
                <div id="intInsights" style="display:flex; flex-direction:column; gap:10px;">
                  <!-- bulles injectées par JS -->
                </div>
              </div>
            </div>

            <!-- Répondre (dépliable) -->
            <details class="card" style="margin-top:12px; padding:12px;">
              <summary style="cursor:pointer; user-select:none;">
                <strong>Répondre</strong> (optionnel) — 1 crédit
                <span style="color:var(--text-muted); font-size:.9rem;">(on reste minimal tant que vous ne l’ouvrez pas)</span>
              </summary>

              <div style="margin-top:12px;">
                <p style="color:var(--text-muted); margin-top:0;">
                  Décrivez ce que vous souhaitez répondre. Camille génère une réponse dans la <strong>langue d’origine</strong>, et une <strong>version FR</strong> de contrôle.
                </p>

                <div class="form-field">
                  <span>Votre intention de réponse</span>
                  <textarea
                    id="intReplyGoal"
                    rows="4"
                    placeholder="Ex : répondre poliment, demander une précision, refuser, négocier, proposer un créneau…"
                  ></textarea>
                </div>

                <p id="intReplyError" style="color: var(--danger); font-size:.9rem; min-height:1.2em;"></p>

                <button id="intReplyBtn" type="button" class="btn btn-secondary">
                  Générer une réponse
                </button>

                <div class="grid grid-2" style="gap:12px; margin-top:12px;">
                  <div class="card" style="padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; gap:8px;">
                      <h3 style="margin:0;">Réponse (langue d’origine)</h3>
                      <button type="button" class="btn btn-ghost" id="btnCopyReply">Copier</button>
                    </div>
                    <pre
                      id="intReply"
                      style="white-space:pre-wrap; margin-top:10px; background:#020617;
                        border-radius:12px; padding:12px; border:1px solid var(--border-subtle); min-height:140px;"
                    ></pre>
                  </div>

                  <div class="card" style="padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; gap:8px;">
                      <h3 style="margin:0;">FR (contrôle)</h3>
                      <button type="button" class="btn btn-ghost" id="btnCopyReplyFR">Copier</button>
                    </div>
                    <pre
                      id="intReplyFR"
                      style="white-space:pre-wrap; margin-top:10px; background:#020617;
                        border-radius:12px; padding:12px; border:1px solid var(--border-subtle); min-height:140px;"
                    ></pre>
                  </div>
                </div>
              </div>
            </details>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <span>© ContextaLingua</span>
        <nav class="footer-nav">
          <a href="contact.html">Contact</a>
        </nav>
      </div>
    </footer>

    <!-- Scripts (ordre important) -->
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/languages.js"></script>
    <script src="js/interpret.js"></script>
  </body>
</html>
